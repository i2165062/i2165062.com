
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title>i21 Chain Debug / Web90 Explorer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.10.0/ethers.umd.min.js"></script>
  <style>
    body {
      direction: rtl;
      font-family: Tahoma, sans-serif;
      background:#111;
      color:#eee;
      margin:0;
      padding:20px;
    }
    h1 { text-align:center; }
    .card {
      max-width:900px;
      margin:10px auto;
      padding:15px;
      border:1px solid #555;
      background:#1b1b1b;
    }
    button {
      padding:8px 12px;
      margin-top:6px;
      cursor:pointer;
    }
    input {
      width:100%;
      padding:6px;
      margin-top:4px;
      direction:ltr;
    }
    pre {
      background:#000;
      color:#0f0;
      padding:10px;
      overflow:auto;
      max-height:250px;
      font-size:12px;
    }
    label { font-size:13px; font-weight:bold; }
  </style>
</head>
<body>

<h1>ğŸ§ª i21 Chain Debug / Web90 Explorer</h1>

<div class="card">
  <h3>Û±) ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ù†ÙˆØ¯</h3>
  <p>RPC: <code id="rpcUrl"></code></p>
  <button onclick="checkConnection()">Ú†Ú© Ú©Ø±Ø¯Ù† Ø§ØªØµØ§Ù„ Ùˆ Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù„Ø§Ú©</button>
  <pre id="connLog"></pre>
</div>

<div class="card">
  <h3>Û²) ØªØ³Øª ØªØ§Ø¨Ø¹ getPage Ø§Ø² Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Web90</h3>
  <p>Contract: <code id="contractAddr"></code></p>
  <label>Ø¢Ø¯Ø±Ø³ Ú©Ø§Ø±Ø¨Ø± (owner):</label>
  <input id="ownerInput" placeholder="0x...">
  <button onclick="callGetPage()">ØµØ¯Ø§ Ø²Ø¯Ù† getPage(owner)</button>
  <pre id="pageLog"></pre>
</div>

<script>
  // ğŸ”§ Ø§ÛŒÙ† Ø¯Ùˆ Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ Ø­ØªÙ…Ø§Ù‹ Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± ÙØ¹Ù„ÛŒ Ø®ÙˆØ¯Øª Ø³Øª Ú©Ù†
  const RPC_URL = "http://188.209.138.136:8545";
  const CONTRACT_ADDRESS = ""; // Ø§Ú¯Ø± Ø¯ÙˆØ¨Ø§Ø±Ù‡ deploy Ú©Ø±Ø¯ÛŒØŒ Ø§ÛŒÙ†Ø¬Ø§ Ø±Ø§ Ø¢Ù¾Ø¯ÛŒØª Ú©Ù†

  const ABI = [
    "function getPage(address owner) view returns (string title, string html, uint256 lastUpdate)"
  ];

  document.getElementById("rpcUrl").textContent = RPC_URL;
  document.getElementById("contractAddr").textContent = CONTRACT_ADDRESS;

  const connLog = document.getElementById("connLog");
  const pageLog = document.getElementById("pageLog");

const provider = new ethers.JsonRpcProvider("http://188.209.138.136:8545");//la
  const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, provider);

  async function checkConnection() {
    connLog.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ú†Ú© Ú©Ø±Ø¯Ù†...\n";
    try {
      const net = await provider.getNetwork();
      const block = await provider.getBlockNumber();
      connLog.textContent += "âœ… Connected to RPC\n";
      connLog.textContent += "chainId: " + net.chainId + "\n";
      connLog.textContent += "latest block: " + block + "\n";
    } catch (e) {
      connLog.textContent += "âŒ ERROR:\n" + (e.message || e.toString()) + "\n";
    }
  }

  async function callGetPage() {
    const owner = document.getElementById("ownerInput").value.trim();
    pageLog.textContent = "";
    if (!ethers.isAddress(owner)) {
      pageLog.textContent = "âŒ Ø¢Ø¯Ø±Ø³ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.";
      return;
    }
    pageLog.textContent = "Ø¯Ø± Ø­Ø§Ù„ ØµØ¯Ø§ Ø²Ø¯Ù† getPage(" + owner + ") ...\n";
    try {
      const result = await contract.getPage(owner);
      const [title, html, ts] = result;
      pageLog.textContent += "âœ… OK\n";
      pageLog.textContent += "title: " + title + "\n";
      pageLog.textContent += "html length: " + (html ? html.length : 0) + "\n";
      pageLog.textContent += "timestamp: " + ts.toString() + "\n";
    } catch (e) {
      pageLog.textContent += "âŒ ERROR:\n" + (e.message || e.toString()) + "\n";
    }
  }
</script>

</body>
</html>
